<!-- -*- mode: jinja2 -*- -->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="MPAS dynamical core solves the fully compressible non-hydrostatic equations of atmospheric motion.">
    <meta name="author" content="CAM-SIMA & MPAS Developers">
    <link href="../favicon.png" rel="icon">

    <title>set_analytic_initial_condition â€“ MPAS Dynamical Core</title>

    <!-- Bootstrap -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      crossorigin="anonymous"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      rel="stylesheet"
    >
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      crossorigin="anonymous"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
    ></script>
    <!-- Font Awesome -->
    <link href="../css/fontawesome.min.css" rel="stylesheet">
    <link href="../css/brands.min.css" rel="stylesheet">
    <link href="../css/regular.min.css" rel="stylesheet">
    <link href="../css/solid.min.css" rel="stylesheet">
    <link href="../css/v4-font-face.min.css" rel="stylesheet">
    <link href="../css/v4-shims.min.css" rel="stylesheet">
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { equationNumbers: { autoNumber: "AMS" } }
      });
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
      async
      crossorigin="anonymous"
      integrity="sha256-DViIOMYdwlM/axqoGDPeUyf0urLoHMN4QACBKyB58Uw="
    ></script>
    <!-- Other scripts and stylesheets -->
    <link href="../css/local.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <script src="../js/svg-pan-zoom.min.js"></script>
  </head>

  <body>
    <!-- Fixed navbar -->
    <div class="container-fluid mb-sm-4 mb-xl-2">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
        <div class="container">
          <a class="navbar-brand" href="../index.html"
            >MPAS Dynamical Core </a
          >
          <button
            class="navbar-toggler"
            data-bs-target="#navbar"
            data-bs-toggle="collapse"
            type="button"
            aria-controls="navbar"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="navbar-collapse collapse" id="navbar">
            <ul class="navbar-nav">
                  <li class="nav-item">
                    <a class="nav-link" href="../lists/files.html">Source Files</a>
                  </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/modules.html">Modules</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/procedures.html">Procedures</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/absint.html">Abstract Interfaces</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="../lists/types.html">Derived Types</a>
                </li>
            </ul>
          </div>
        </div>
      </nav>
    </div>

    <div class="container">
  <div class="row">
    <h1>
      set_analytic_initial_condition
      <small
        >Subroutine</small
      >
      
    </h1>
      <div class="container p-2 mb-4 bg-light border rounded-3">
    <div class="row align-items-center justify-content-between" id="info-bar">
      <div class="col">
        <ul class="list-inline">

            <li class="list-inline-item" id="statements"><i class="fa fa-list-ol"></i>
              <a data-bs-toggle="tooltip" data-bs-placement="bottom" data-bs-html="true"
                 title=" 7.1% of total for procedures.">271 statements</a>
            </li>

            <li class="list-inline-item" id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/dyn_comp.F90"> Source File</a>
            </li>
        </ul>
      </div>
      <div class="col">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb justify-content-end mb-0">
                <li class="breadcrumb-item"><a href='../sourcefile/dyn_comp.f90.html'>dyn_comp.F90</a></li>
                <li class="breadcrumb-item"><a href='../module/dyn_comp.html'>dyn_comp</a></li>
            <li class="breadcrumb-item active" aria-current="page">set_analytic_initial_condition</li>
          </ol>
        </nav>
      </div>
    </div>
  </div>
  <script>
    // Enable Bootstrap tooltips
    (function () {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    })();
  </script>

  </div>

  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">  <div id="sidebar">
      <h3>Contents</h3>
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#vars-0"
         aria-expanded="false" aria-controls="vars-0">
         <h4 class="card-header bg-primary text-white">Variables</h4>
      </a>
      <div id="vars-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-buffer_2d_real">buffer_2d_real</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-buffer_3d_real">buffer_3d_real</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-global_grid_index">global_grid_index</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-lat_rad">lat_rad</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-lon_rad">lon_rad</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-subname~4">subname</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-z_int">z_int</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#variable-zgrid~2">zgrid</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
  
  
      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#funcs-0"
         aria-expanded="false" aria-controls="funcs-0">
         <h4 class="card-header bg-primary text-white">Functions</h4>
      </a>
      <div id="funcs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-p_by_hypsometric_equation">p_by_hypsometric_equation</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-theta_by_poisson_equation">theta_by_poisson_equation</a>
        </div>
      </div>
    </div>

      <div class="card mb-4">
      <a data-bs-toggle="collapse" href="#subs-0"
         aria-expanded="false" aria-controls="subs-0">
         <h4 class="card-header bg-primary text-white">Subroutines</h4>
      </a>
      <div id="subs-0" class="collapse">
        <div class="list-group list-group-flush">
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-final_shared_variables">final_shared_variables</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-init_shared_variables">init_shared_variables</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_rho_base_theta_base">set_mpas_state_rho_base_theta_base</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_rho_theta">set_mpas_state_rho_theta</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_scalars">set_mpas_state_scalars</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_u">set_mpas_state_u</a>
            <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_w">set_mpas_state_w</a>
        </div>
      </div>
    </div>

  
  
  
  
  
  
  
    <div class="card card-primary">
      <div class="card-header text-left"><h3 class="card-title">Source Code</h3></div>
      <div class="list-group">
        <a class="list-group-item" href="../proc/set_analytic_initial_condition.html#src">set_analytic_initial_condition</a>
      </div>
    </div>


  </div>
</div>

    <div class="col-md-9" id="text">
      <h2>private  subroutine set_analytic_initial_condition()  
</h2>
          <div class="card mb-4">
      <h3 class="card-header card-title bg-light">Uses</h3>
      <div class="card-body">
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
              <ul class="list-inline">
                  <li class="list-inline-item">cam_logfile</li>
                  <li class="list-inline-item">shr_kind_mod</li>
              </ul>
            </li>
            <li class="list-group-item">
              <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~set_analytic_initial_condition~~UsesGraph Pages: 1 -->
<svg id="procset_analytic_initial_conditionUsesGraph" width="295pt" height="74pt"
 viewBox="0.00 0.00 295.00 74.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~set_analytic_initial_condition~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 70)">
<title>proc~~set_analytic_initial_condition~~UsesGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-70 291,-70 291,4 -4,4"/>
<!-- proc~set_analytic_initial_condition -->
<g id="proc~~set_analytic_initial_condition~~UsesGraph_node1" class="node">
<title>proc~set_analytic_initial_condition</title>
<polygon fill="none" stroke="black" points="287,-45 122,-45 122,-21 287,-21 287,-45"/>
<text text-anchor="middle" x="204.5" y="-30.6" font-family="Helvetica,sans-Serif" font-size="10.50">set_analytic_initial_condition</text>
</g>
<!-- cam_logfile -->
<g id="proc~~set_analytic_initial_condition~~UsesGraph_node2" class="node">
<title>cam_logfile</title>
<polygon fill="#337ab7" stroke="#337ab7" points="80,-66 6,-66 6,-42 80,-42 80,-66"/>
<text text-anchor="middle" x="43" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_logfile</text>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;cam_logfile -->
<g id="proc~~set_analytic_initial_condition~~UsesGraph_edge1" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;cam_logfile</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M121.88,-43.75C111.07,-45.17 100.31,-46.59 90.39,-47.89"/>
<polygon fill="#000000" stroke="#000000" points="89.84,-44.43 80.39,-49.21 90.76,-51.37 89.84,-44.43"/>
</g>
<!-- shr_kind_mod -->
<g id="proc~~set_analytic_initial_condition~~UsesGraph_node3" class="node">
<title>shr_kind_mod</title>
<polygon fill="#337ab7" stroke="#337ab7" points="86,-24 0,-24 0,0 86,0 86,-24"/>
<text text-anchor="middle" x="43" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">shr_kind_mod</text>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;shr_kind_mod -->
<g id="proc~~set_analytic_initial_condition~~UsesGraph_edge2" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;shr_kind_mod</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M121.88,-22.25C113.15,-21.1 104.45,-19.96 96.2,-18.87"/>
<polygon fill="#000000" stroke="#000000" points="96.39,-15.37 86.02,-17.53 95.48,-22.31 96.39,-15.37"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#UsesGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="UsesGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="518pt" height="32pt"
 viewBox="0.00 0.00 517.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 513.5,-28 513.5,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234,-24 164,-24 164,0 234,0 234,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="310,-24 252,-24 252,0 310,0 310,-24"/>
<text text-anchor="middle" x="281" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="386,-24 328,-24 328,0 386,0 386,-24"/>
<text text-anchor="middle" x="357" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="509.5,-24 404.5,-24 404.5,0 509.5,0 509.5,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a submodule to the (sub)module which it is
descended from. Dashed arrows point from a module or program unit to 
modules which it uses.
</p>
 </div>
            </div>
          </div>
        </div>
            </li>
        </ul>
      </div>
    </div>


        <p>Set analytic initial condition for MPAS.
(KCW, 2024-05-22)</p>


      <h3>Arguments</h3>
        <em>None</em>
        <br>
        <br>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Calls</h3>
          </div>
          <div class="card-body"><div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~set_analytic_initial_condition~~CallsGraph Pages: 1 -->
<svg id="procset_analytic_initial_conditionCallsGraph" width="641pt" height="283pt"
 viewBox="0.00 0.00 641.00 282.97" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~set_analytic_initial_condition~~CallsGraph" class="graph" transform="scale(0.31 0.31) rotate(0) translate(4 912)">
<title>proc~~set_analytic_initial_condition~~CallsGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-912 2071,-912 2071,4 -4,4"/>
<!-- proc~set_analytic_initial_condition -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node1" class="node">
<title>proc~set_analytic_initial_condition</title>
<polygon fill="none" stroke="black" points="165,-577 0,-577 0,-553 165,-553 165,-577"/>
<text text-anchor="middle" x="82.5" y="-562.6" font-family="Helvetica,sans-Serif" font-size="10.50">set_analytic_initial_condition</text>
</g>
<!-- none~final_shared_variables -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node2" class="node">
<title>none~final_shared_variables</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node2"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-final_shared_variables" xlink:title="final_shared_variables">
<polygon fill="#d9534f" stroke="#d9534f" points="372.5,-762 241.5,-762 241.5,-738 372.5,-738 372.5,-762"/>
<text text-anchor="middle" x="307" y="-747.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">final_shared_variables</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~final_shared_variables -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge1" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~final_shared_variables</title>
<path fill="none" stroke="#000000" d="M88.45,-577.3C101.62,-608.32 140.68,-690.06 201,-729 210.21,-734.94 220.74,-739.26 231.51,-742.39"/>
<polygon fill="#000000" stroke="#000000" points="230.87,-745.84 241.42,-744.94 232.61,-739.06 230.87,-745.84"/>
</g>
<!-- none~init_shared_variables -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node3" class="node">
<title>none~init_shared_variables</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node3"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-init_shared_variables" xlink:title="init_shared_variables">
<polygon fill="#d9534f" stroke="#d9534f" points="369,-720 245,-720 245,-696 369,-696 369,-720"/>
<text text-anchor="middle" x="307" y="-705.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">init_shared_variables</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~init_shared_variables -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge2" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~init_shared_variables</title>
<path fill="none" stroke="#000000" d="M95.18,-577.2C115.24,-597.6 158.21,-638.95 201,-665 219.05,-675.99 240.42,-685.32 259.15,-692.46"/>
<polygon fill="#000000" stroke="#000000" points="258.08,-695.79 268.67,-695.98 260.51,-689.23 258.08,-695.79"/>
</g>
<!-- none~set_mpas_state_rho_base_theta_base -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node4" class="node">
<title>none~set_mpas_state_rho_base_theta_base</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node4"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_rho_base_theta_base" xlink:title="set_mpas_state_rho_base_theta_base">
<polygon fill="#d9534f" stroke="#d9534f" points="413,-548 201,-548 201,-524 413,-524 413,-548"/>
<text text-anchor="middle" x="307" y="-533.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_mpas_state_rho_base_theta_base</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_rho_base_theta_base -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge3" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_rho_base_theta_base</title>
<path fill="none" stroke="#000000" d="M165.09,-554.37C177.74,-552.72 190.94,-551 203.97,-549.3"/>
<polygon fill="#000000" stroke="#000000" points="204.43,-552.77 213.89,-548 203.53,-545.83 204.43,-552.77"/>
</g>
<!-- none~set_mpas_state_rho_theta -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node5" class="node">
<title>none~set_mpas_state_rho_theta</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node5"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_rho_theta" xlink:title="set_mpas_state_rho_theta">
<polygon fill="#d9534f" stroke="#d9534f" points="382.5,-426 231.5,-426 231.5,-402 382.5,-402 382.5,-426"/>
<text text-anchor="middle" x="307" y="-411.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_mpas_state_rho_theta</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_rho_theta -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge4" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_rho_theta</title>
<path fill="none" stroke="#000000" d="M101.33,-552.9C140.39,-526.39 233.66,-463.09 279.56,-431.94"/>
<polygon fill="#000000" stroke="#000000" points="281.77,-434.67 288.08,-426.16 277.84,-428.88 281.77,-434.67"/>
</g>
<!-- none~set_mpas_state_scalars -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node6" class="node">
<title>none~set_mpas_state_scalars</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node6"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_scalars" xlink:title="set_mpas_state_scalars">
<polygon fill="#d9534f" stroke="#d9534f" points="375.5,-226 238.5,-226 238.5,-202 375.5,-202 375.5,-226"/>
<text text-anchor="middle" x="307" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_mpas_state_scalars</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_scalars -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge5" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_scalars</title>
<path fill="none" stroke="#000000" d="M85.4,-552.94C92.73,-509.95 122.75,-362.09 201,-273 217.63,-254.06 241.88,-239.88 262.89,-230.17"/>
<polygon fill="#000000" stroke="#000000" points="264.54,-233.27 272.27,-226.02 261.71,-226.86 264.54,-233.27"/>
</g>
<!-- none~set_mpas_state_u -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node7" class="node">
<title>none~set_mpas_state_u</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node7"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_u" xlink:title="set_mpas_state_u">
<polygon fill="#d9534f" stroke="#d9534f" points="360,-306 254,-306 254,-282 360,-282 360,-306"/>
<text text-anchor="middle" x="307" y="-291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_mpas_state_u</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_u -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge6" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_u</title>
<path fill="none" stroke="#000000" d="M90.64,-552.68C107.82,-523.52 153.55,-448.54 201,-393 226.83,-362.77 261,-331.97 283.23,-312.92"/>
<polygon fill="#000000" stroke="#000000" points="285.76,-315.37 291.12,-306.23 281.23,-310.03 285.76,-315.37"/>
</g>
<!-- none~set_mpas_state_w -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node8" class="node">
<title>none~set_mpas_state_w</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node8"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-set_mpas_state_w" xlink:title="set_mpas_state_w">
<polygon fill="#d9534f" stroke="#d9534f" points="361,-656 253,-656 253,-632 361,-632 361,-656"/>
<text text-anchor="middle" x="307" y="-641.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">set_mpas_state_w</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_w -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge7" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;none~set_mpas_state_w</title>
<path fill="none" stroke="#000000" d="M114.81,-577.08C138.41,-586.1 171.63,-598.61 201,-609 219.8,-615.65 240.61,-622.66 258.72,-628.65"/>
<polygon fill="#000000" stroke="#000000" points="257.87,-632.05 268.47,-631.86 260.06,-625.41 257.87,-632.05"/>
</g>
<!-- proc~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node9" class="node">
<title>proc~dyn_debug_print</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node9"><a xlink:href="../proc/dyn_debug_print.html" xlink:title="dyn_debug_print">
<polygon fill="#d9534f" stroke="#d9534f" points="675,-626 574,-626 574,-602 675,-602 675,-626"/>
<text text-anchor="middle" x="624.5" y="-611.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_debug_print</text>
</a>
</g>
</g>
<!-- proc~set_analytic_initial_condition&#45;&gt;proc~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge8" class="edge">
<title>proc~set_analytic_initial_condition&#45;&gt;proc~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M165.22,-572.42C274.74,-582.35 466.57,-599.76 563.63,-608.57"/>
<polygon fill="#000000" stroke="#000000" points="563.58,-612.08 573.85,-609.49 564.21,-605.11 563.58,-612.08"/>
</g>
<!-- none~init_shared_variables&#45;&gt;proc~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge15" class="edge">
<title>none~init_shared_variables&#45;&gt;proc~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M348.28,-696C405.68,-678.9 510.94,-647.54 573.33,-628.95"/>
<polygon fill="#000000" stroke="#000000" points="574.38,-632.29 582.96,-626.08 572.38,-625.58 574.38,-632.29"/>
</g>
<!-- cam_grid_get_latvals -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node10" class="node">
<title>cam_grid_get_latvals</title>
<polygon fill="#777777" stroke="#777777" points="686.5,-908 562.5,-908 562.5,-884 686.5,-884 686.5,-908"/>
<text text-anchor="middle" x="624.5" y="-893.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_grid_get_latvals</text>
</g>
<!-- none~init_shared_variables&#45;&gt;cam_grid_get_latvals -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge9" class="edge">
<title>none~init_shared_variables&#45;&gt;cam_grid_get_latvals</title>
<path fill="none" stroke="#000000" d="M369.03,-708.65C385.08,-711.68 401.18,-717.69 413,-729 461.29,-775.2 398.95,-830.71 449,-875 476.66,-899.48 517.18,-905.5 552.21,-905.05"/>
<polygon fill="#000000" stroke="#000000" points="552.52,-908.54 562.41,-904.74 552.31,-901.55 552.52,-908.54"/>
</g>
<!-- cam_grid_get_lonvals -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node11" class="node">
<title>cam_grid_get_lonvals</title>
<polygon fill="#777777" stroke="#777777" points="688,-866 561,-866 561,-842 688,-842 688,-866"/>
<text text-anchor="middle" x="624.5" y="-851.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_grid_get_lonvals</text>
</g>
<!-- none~init_shared_variables&#45;&gt;cam_grid_get_lonvals -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge10" class="edge">
<title>none~init_shared_variables&#45;&gt;cam_grid_get_lonvals</title>
<path fill="none" stroke="#000000" d="M369.2,-709.52C384.97,-712.6 400.88,-718.43 413,-729 449.85,-761.16 410.93,-802.29 449,-833 476.98,-855.57 516.17,-861.81 550.32,-861.98"/>
<polygon fill="#000000" stroke="#000000" points="550.78,-865.47 560.74,-861.84 550.69,-858.47 550.78,-865.47"/>
</g>
<!-- cam_grid_id -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node12" class="node">
<title>cam_grid_id</title>
<polygon fill="#777777" stroke="#777777" points="663,-824 586,-824 586,-800 663,-800 663,-824"/>
<text text-anchor="middle" x="624.5" y="-809.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">cam_grid_id</text>
</g>
<!-- none~init_shared_variables&#45;&gt;cam_grid_id -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge11" class="edge">
<title>none~init_shared_variables&#45;&gt;cam_grid_id</title>
<path fill="none" stroke="#000000" d="M369.03,-711.34C384.44,-714.46 400.22,-719.86 413,-729 438.91,-747.54 422.39,-773.48 449,-791 486.39,-815.62 538.23,-818.92 575.69,-817.25"/>
<polygon fill="#000000" stroke="#000000" points="576.06,-820.73 585.84,-816.66 575.66,-813.74 576.06,-820.73"/>
</g>
<!-- check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node13" class="node">
<title>check_allocate</title>
<polygon fill="#777777" stroke="#777777" points="670.5,-348 578.5,-348 578.5,-324 670.5,-324 670.5,-348"/>
<text text-anchor="middle" x="624.5" y="-333.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">check_allocate</text>
</g>
<!-- none~init_shared_variables&#45;&gt;check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge12" class="edge">
<title>none~init_shared_variables&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M366.32,-695.9C383.78,-689.5 401.35,-679.77 413,-665 477.64,-583.08 389.34,-518.6 449,-433 477.93,-391.49 530.6,-365.78 570.53,-351.35"/>
<polygon fill="#000000" stroke="#000000" points="571.84,-354.6 580.13,-348.01 569.53,-347.99 571.84,-354.6"/>
</g>
<!-- endrun -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node15" class="node">
<title>endrun</title>
<polygon fill="#777777" stroke="#777777" points="651.5,-782 597.5,-782 597.5,-758 651.5,-758 651.5,-782"/>
<text text-anchor="middle" x="624.5" y="-767.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">endrun</text>
</g>
<!-- none~init_shared_variables&#45;&gt;endrun -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge13" class="edge">
<title>none~init_shared_variables&#45;&gt;endrun</title>
<path fill="none" stroke="#000000" d="M369.03,-718.09C383.58,-721.07 398.95,-724.71 413,-729 429.58,-734.06 432.3,-739.35 449,-744 495.67,-756.98 551.27,-763.85 586.96,-767.2"/>
<polygon fill="#000000" stroke="#000000" points="587.09,-770.72 597.36,-768.13 587.71,-763.75 587.09,-770.72"/>
</g>
<!-- none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node16" class="node">
<title>none~get_variable_pointer</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node16"><a xlink:href="../type/mpas_dynamical_core_type.html#boundprocedure-get_variable_pointer" xlink:title="mpas_dynamical_core_type%get_variable_pointer">
<polygon fill="#a7506f" stroke="#a7506f" points="1130,-573 851,-573 851,-549 1130,-549 1130,-573"/>
<text text-anchor="middle" x="990.5" y="-558.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%get_variable_pointer</text>
</a>
</g>
</g>
<!-- none~init_shared_variables&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge14" class="edge">
<title>none~init_shared_variables&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M369.29,-716.24C485.73,-730.52 733.28,-753.95 800,-705 842.16,-674.07 797.13,-627.97 836,-593 842.98,-586.72 850.88,-581.54 859.3,-577.3"/>
<polygon fill="#000000" stroke="#000000" points="860.99,-580.38 868.64,-573.05 858.09,-574.01 860.99,-580.38"/>
</g>
<!-- proc~reverse -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node23" class="node">
<title>proc~reverse</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node23"><a xlink:href="../proc/reverse.html" xlink:title="reverse">
<polygon fill="#d94e8f" stroke="#d94e8f" points="651.5,-306 597.5,-306 597.5,-282 651.5,-282 651.5,-306"/>
<text text-anchor="middle" x="624.5" y="-291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">reverse</text>
</a>
</g>
</g>
<!-- none~init_shared_variables&#45;&gt;proc~reverse -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge16" class="edge">
<title>none~init_shared_variables&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M367.6,-695.95C384.8,-689.56 401.91,-679.83 413,-665 459.84,-602.39 394.19,-370.76 449,-315 484.54,-278.84 547.45,-280.77 587.24,-286.58"/>
<polygon fill="#000000" stroke="#000000" points="586.88,-290.07 597.31,-288.21 588,-283.16 586.88,-290.07"/>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge21" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M335.55,-548.09C363.59,-559.92 408.56,-577.65 449,-588 486.51,-597.6 529.53,-604.06 563.47,-608.14"/>
<polygon fill="#000000" stroke="#000000" points="563.36,-611.65 573.69,-609.33 564.17,-604.7 563.36,-611.65"/>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge17" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M323.21,-523.92C348.59,-503.99 401.5,-463.39 449,-433 496.84,-402.39 554.93,-371.23 590.55,-352.76"/>
<polygon fill="#000000" stroke="#000000" points="592.25,-355.82 599.53,-348.12 589.04,-349.6 592.25,-355.82"/>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge18" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M413.03,-547.35C425.15,-548.38 437.34,-549.3 449,-550 581.3,-557.9 732.11,-560.43 840.75,-561.11"/>
<polygon fill="#000000" stroke="#000000" points="840.78,-564.61 850.8,-561.17 840.82,-557.62 840.78,-564.61"/>
</g>
<!-- none~p_by_hypsometric_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node17" class="node">
<title>none~p_by_hypsometric_equation</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node17"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-p_by_hypsometric_equation" xlink:title="p_by_hypsometric_equation">
<polygon fill="#d94e8f" stroke="#d94e8f" points="705,-466 544,-466 544,-442 705,-442 705,-466"/>
<text text-anchor="middle" x="624.5" y="-451.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">p_by_hypsometric_equation</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;none~p_by_hypsometric_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge19" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;none~p_by_hypsometric_equation</title>
<path fill="none" stroke="#000000" d="M330.23,-523.98C357.41,-509.85 405.23,-486.83 449,-475 476.15,-467.66 506.38,-462.88 533.94,-459.77"/>
<polygon fill="#000000" stroke="#000000" points="534.39,-463.25 543.96,-458.7 533.65,-456.29 534.39,-463.25"/>
</g>
<!-- none~theta_by_poisson_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node18" class="node">
<title>none~theta_by_poisson_equation</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node18"><a xlink:href="../proc/set_analytic_initial_condition.html#proc-theta_by_poisson_equation" xlink:title="theta_by_poisson_equation">
<polygon fill="#d94e8f" stroke="#d94e8f" points="703,-508 546,-508 546,-484 703,-484 703,-508"/>
<text text-anchor="middle" x="624.5" y="-493.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">theta_by_poisson_equation</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;none~theta_by_poisson_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge20" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;none~theta_by_poisson_equation</title>
<path fill="none" stroke="#000000" d="M402.66,-524C444.92,-518.64 494.4,-512.37 535.81,-507.12"/>
<polygon fill="#000000" stroke="#000000" points="536.4,-510.57 545.88,-505.84 535.52,-503.63 536.4,-510.57"/>
</g>
<!-- proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node20" class="node">
<title>proc~dyn_mpas_exchange_halo</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node20"><a xlink:href="../proc/dyn_mpas_exchange_halo.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_exchange_halo">
<polygon fill="#d9534f" stroke="#d9534f" points="1145,-248 836,-248 836,-224 1145,-224 1145,-248"/>
<text text-anchor="middle" x="990.5" y="-233.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_exchange_halo</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge22" class="edge">
<title>none~set_mpas_state_rho_base_theta_base&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M413.04,-542.84C537.5,-549.08 736.05,-552.61 800,-517 905.53,-458.24 963.66,-313.05 982.56,-257.81"/>
<polygon fill="#000000" stroke="#000000" points="985.89,-258.89 985.72,-248.3 979.24,-256.68 985.89,-258.89"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;proc~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge28" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;proc~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M323.21,-426.08C348.59,-446.01 401.5,-486.61 449,-517 496.84,-547.61 554.93,-578.77 590.55,-597.24"/>
<polygon fill="#000000" stroke="#000000" points="589.04,-600.4 599.53,-601.88 592.25,-594.18 589.04,-600.4"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge23" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M335.55,-401.91C363.59,-390.08 408.56,-372.35 449,-362 488.13,-351.98 533.24,-345.39 567.8,-341.35"/>
<polygon fill="#000000" stroke="#000000" points="568.62,-344.78 578.16,-340.17 567.83,-337.82 568.62,-344.78"/>
</g>
<!-- dyn_set_inic_col -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node14" class="node">
<title>dyn_set_inic_col</title>
<polygon fill="#777777" stroke="#777777" points="673.5,-226 575.5,-226 575.5,-202 673.5,-202 673.5,-226"/>
<text text-anchor="middle" x="624.5" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_set_inic_col</text>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;dyn_set_inic_col -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge24" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;dyn_set_inic_col</title>
<path fill="none" stroke="#000000" d="M321.7,-401.94C342.17,-383.72 381.7,-347.82 413,-315 429.97,-297.21 428.63,-286.76 449,-273 484.12,-249.27 529.65,-234.3 565.4,-225.38"/>
<polygon fill="#000000" stroke="#000000" points="566.3,-228.76 575.2,-223.02 564.66,-221.95 566.3,-228.76"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge25" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M382.74,-404.44C481.14,-394.63 658.24,-386.6 800,-433 869.57,-455.77 937.22,-512.14 969.64,-541.89"/>
<polygon fill="#000000" stroke="#000000" points="967.4,-544.59 977.1,-548.85 972.17,-539.47 967.4,-544.59"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;none~p_by_hypsometric_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge26" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;none~p_by_hypsometric_equation</title>
<path fill="none" stroke="#000000" d="M382.77,-423.48C428.02,-429.22 486.01,-436.57 533.73,-442.62"/>
<polygon fill="#000000" stroke="#000000" points="533.39,-446.1 543.75,-443.89 534.27,-439.16 533.39,-446.1"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;none~theta_by_poisson_equation -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge27" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;none~theta_by_poisson_equation</title>
<path fill="none" stroke="#000000" d="M330.23,-426.02C357.41,-440.15 405.23,-463.17 449,-475 476.68,-482.48 507.55,-487.3 535.53,-490.4"/>
<polygon fill="#000000" stroke="#000000" points="535.39,-493.91 545.7,-491.47 536.12,-486.95 535.39,-493.91"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge29" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M382.55,-402.25C403.98,-399.05 427.39,-395.72 449,-393 604.59,-373.44 651.91,-408.59 800,-357 866.94,-333.68 934.27,-282.55 967.75,-254.81"/>
<polygon fill="#000000" stroke="#000000" points="970.11,-257.4 975.51,-248.29 965.61,-252.04 970.11,-257.4"/>
</g>
<!-- none~set_mpas_state_rho_theta&#45;&gt;proc~reverse -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge30" class="edge">
<title>none~set_mpas_state_rho_theta&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M320.7,-401.71C343.97,-380.02 395.93,-335.34 449,-315 494.51,-297.56 551.17,-293.71 587.34,-293.28"/>
<polygon fill="#000000" stroke="#000000" points="587.43,-296.78 597.42,-293.24 587.41,-289.78 587.43,-296.78"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;proc~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge34" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;proc~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M346.77,-226.01C369.72,-235.17 397.3,-250.18 413,-273 475.14,-363.31 386.66,-426.84 449,-517 477.68,-558.48 530.13,-584.15 570.07,-598.57"/>
<polygon fill="#000000" stroke="#000000" points="569.07,-601.93 579.67,-601.91 571.37,-595.32 569.07,-601.93"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge31" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M335.52,-226.16C357.72,-236.72 389.07,-253.37 413,-273 432.01,-288.59 427.32,-303.41 449,-315 485.37,-334.44 531.98,-339.21 567.87,-339.38"/>
<polygon fill="#000000" stroke="#000000" points="568.2,-342.88 578.17,-339.3 568.15,-335.88 568.2,-342.88"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;dyn_set_inic_col -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge32" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;dyn_set_inic_col</title>
<path fill="none" stroke="#000000" d="M375.68,-214C432.16,-214 511.79,-214 565.41,-214"/>
<polygon fill="#000000" stroke="#000000" points="565.44,-217.5 575.44,-214 565.44,-210.5 565.44,-217.5"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge33" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M375.88,-202.02C493.86,-182.68 730.75,-150.77 800,-193 808.37,-198.1 940.14,-461.86 978.87,-539.64"/>
<polygon fill="#000000" stroke="#000000" points="975.92,-541.55 983.51,-548.95 982.19,-538.44 975.92,-541.55"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge35" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M319.36,-201.89C341.63,-179.15 393.67,-130.77 449,-113 597.53,-65.29 650.42,-68.71 800,-113 868.99,-133.43 936.42,-187.74 969.09,-216.89"/>
<polygon fill="#000000" stroke="#000000" points="966.87,-219.6 976.63,-223.72 971.57,-214.41 966.87,-219.6"/>
</g>
<!-- proc~dyn_mpas_get_constituent_name -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node21" class="node">
<title>proc~dyn_mpas_get_constituent_name</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node21"><a xlink:href="../proc/dyn_mpas_get_constituent_name.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_constituent_name">
<polygon fill="#d94e8f" stroke="#d94e8f" points="797.5,-66 451.5,-66 451.5,-42 797.5,-42 797.5,-66"/>
<text text-anchor="middle" x="624.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_constituent_name</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_get_constituent_name -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge36" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_get_constituent_name</title>
<path fill="none" stroke="#000000" d="M316.58,-201.82C336.38,-174.74 388.3,-109.62 449,-80 457.88,-75.67 467.29,-72.02 476.96,-68.94"/>
<polygon fill="#000000" stroke="#000000" points="478.11,-72.25 486.7,-66.05 476.12,-65.54 478.11,-72.25"/>
</g>
<!-- proc~dyn_mpas_map_constituent_index -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node22" class="node">
<title>proc~dyn_mpas_map_constituent_index</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node22"><a xlink:href="../proc/dyn_mpas_map_constituent_index.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_map_constituent_index">
<polygon fill="#d94e8f" stroke="#d94e8f" points="800,-24 449,-24 449,0 800,0 800,-24"/>
<text text-anchor="middle" x="624.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_map_constituent_index</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_map_constituent_index -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge37" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;proc~dyn_mpas_map_constituent_index</title>
<path fill="none" stroke="#000000" d="M313.4,-201.6C328.87,-167.77 376.87,-73.76 449,-33 452.08,-31.26 455.24,-29.63 458.47,-28.11"/>
<polygon fill="#000000" stroke="#000000" points="459.93,-31.29 467.72,-24.11 457.16,-24.87 459.93,-31.29"/>
</g>
<!-- none~set_mpas_state_scalars&#45;&gt;proc~reverse -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge38" class="edge">
<title>none~set_mpas_state_scalars&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M355.58,-226.06C419.1,-242.17 530.24,-270.35 587.35,-284.83"/>
<polygon fill="#000000" stroke="#000000" points="586.81,-288.31 597.37,-287.37 588.53,-281.52 586.81,-288.31"/>
</g>
<!-- none~set_mpas_state_u&#45;&gt;proc~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge42" class="edge">
<title>none~set_mpas_state_u&#45;&gt;proc~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M326.02,-306.23C349.46,-323.06 390.13,-355.59 413,-393 442.93,-441.96 413.23,-472.13 449,-517 481.17,-557.35 534.94,-583.58 574.31,-598.46"/>
<polygon fill="#000000" stroke="#000000" points="573.39,-601.85 583.98,-602 575.8,-595.28 573.39,-601.85"/>
</g>
<!-- none~set_mpas_state_u&#45;&gt;check_allocate -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge39" class="edge">
<title>none~set_mpas_state_u&#45;&gt;check_allocate</title>
<path fill="none" stroke="#000000" d="M360.18,-302.13C386.75,-306.18 419.57,-311.04 449,-315 488.74,-320.35 533.66,-325.74 567.97,-329.72"/>
<polygon fill="#000000" stroke="#000000" points="567.93,-333.24 578.26,-330.91 568.73,-326.28 567.93,-333.24"/>
</g>
<!-- none~set_mpas_state_u&#45;&gt;dyn_set_inic_col -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge40" class="edge">
<title>none~set_mpas_state_u&#45;&gt;dyn_set_inic_col</title>
<path fill="none" stroke="#000000" d="M334.2,-281.98C362.09,-269.66 407.8,-250.82 449,-240 486.99,-230.02 530.7,-223.52 564.88,-219.51"/>
<polygon fill="#000000" stroke="#000000" points="565.62,-222.95 575.16,-218.34 564.83,-215.99 565.62,-222.95"/>
</g>
<!-- none~set_mpas_state_u&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge41" class="edge">
<title>none~set_mpas_state_u&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M360.01,-285.2C470.64,-267.54 725.31,-232.74 800,-273 908.64,-331.57 965.22,-482.65 983.11,-539.2"/>
<polygon fill="#000000" stroke="#000000" points="979.81,-540.38 986.09,-548.91 986.5,-538.32 979.81,-540.38"/>
</g>
<!-- proc~dyn_mpas_compute_edge_wind -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node19" class="node">
<title>proc~dyn_mpas_compute_edge_wind</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node19"><a xlink:href="../proc/dyn_mpas_compute_edge_wind.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_compute_edge_wind">
<polygon fill="#d9534f" stroke="#d9534f" points="793.5,-146 455.5,-146 455.5,-122 793.5,-122 793.5,-146"/>
<text text-anchor="middle" x="624.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_compute_edge_wind</text>
</a>
</g>
</g>
<!-- none~set_mpas_state_u&#45;&gt;proc~dyn_mpas_compute_edge_wind -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge43" class="edge">
<title>none~set_mpas_state_u&#45;&gt;proc~dyn_mpas_compute_edge_wind</title>
<path fill="none" stroke="#000000" d="M335.52,-281.84C357.72,-271.28 389.07,-254.63 413,-235 432.01,-219.41 428.63,-206.76 449,-193 480.11,-171.98 519.39,-157.83 552.8,-148.67"/>
<polygon fill="#000000" stroke="#000000" points="553.74,-152.05 562.51,-146.1 551.95,-145.28 553.74,-152.05"/>
</g>
<!-- none~set_mpas_state_u&#45;&gt;proc~reverse -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge44" class="edge">
<title>none~set_mpas_state_u&#45;&gt;proc~reverse</title>
<path fill="none" stroke="#000000" d="M360.1,-294C424.22,-294 531.46,-294 587.26,-294"/>
<polygon fill="#000000" stroke="#000000" points="587.39,-297.5 597.39,-294 587.39,-290.5 587.39,-297.5"/>
</g>
<!-- none~set_mpas_state_w&#45;&gt;proc~dyn_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge46" class="edge">
<title>none~set_mpas_state_w&#45;&gt;proc~dyn_debug_print</title>
<path fill="none" stroke="#000000" d="M361.16,-638.94C417.16,-633.62 505.15,-625.25 563.58,-619.7"/>
<polygon fill="#000000" stroke="#000000" points="564.14,-623.16 573.77,-618.73 563.48,-616.19 564.14,-623.16"/>
</g>
<!-- none~set_mpas_state_w&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge45" class="edge">
<title>none~set_mpas_state_w&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M337.23,-656.09C418.19,-687.5 649.27,-762.85 800,-668 831.29,-648.31 806.89,-615.8 836,-593 844.45,-586.38 853.94,-581.04 863.95,-576.75"/>
<polygon fill="#000000" stroke="#000000" points="865.24,-580 873.27,-573.09 862.68,-573.48 865.24,-580"/>
</g>
<!-- none~set_mpas_state_w&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge47" class="edge">
<title>none~set_mpas_state_w&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M361.24,-650.28C473.7,-662.39 730.76,-683.75 800,-635 836.92,-609.01 817.8,-581.32 836,-540 883.83,-431.42 950.99,-306.27 977.79,-257.24"/>
<polygon fill="#000000" stroke="#000000" points="981,-258.68 982.74,-248.23 974.86,-255.31 981,-258.68"/>
</g>
<!-- stringify -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node24" class="node">
<title>stringify</title>
<polygon fill="#777777" stroke="#777777" points="1018,-626 963,-626 963,-602 1018,-602 1018,-626"/>
<text text-anchor="middle" x="990.5" y="-611.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stringify</text>
</g>
<!-- proc~dyn_debug_print&#45;&gt;stringify -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge48" class="edge">
<title>proc~dyn_debug_print&#45;&gt;stringify</title>
<path fill="none" stroke="#000000" d="M675.35,-614C749.31,-614 886.44,-614 952.3,-614"/>
<polygon fill="#000000" stroke="#000000" points="952.62,-617.5 962.62,-614 952.62,-610.5 952.62,-617.5"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node29" class="node">
<title>proc~dyn_mpas_get_variable_pointer_c0</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node29"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_c0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c0">
<polygon fill="#d9534f" stroke="#d9534f" points="1537,-478 1181,-478 1181,-454 1537,-454 1537,-478"/>
<text text-anchor="middle" x="1359" y="-463.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge49" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1016.27,-548.97C1051.84,-532.24 1119.84,-502.3 1181,-487 1191.91,-484.27 1203.29,-481.89 1214.79,-479.82"/>
<polygon fill="#000000" stroke="#000000" points="1215.66,-483.22 1224.92,-478.08 1214.47,-476.32 1215.66,-483.22"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node30" class="node">
<title>proc~dyn_mpas_get_variable_pointer_c1</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node30"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_c1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c1">
<polygon fill="#d9534f" stroke="#d9534f" points="1537,-562 1181,-562 1181,-538 1537,-538 1537,-562"/>
<text text-anchor="middle" x="1359" y="-547.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_c1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge50" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_c1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1130.06,-556.84C1143.43,-556.44 1157.15,-556.03 1170.89,-555.62"/>
<polygon fill="#000000" stroke="#000000" points="1171.01,-559.11 1180.9,-555.32 1170.8,-552.12 1171.01,-559.11"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node31" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i0</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node31"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i0">
<polygon fill="#d9534f" stroke="#d9534f" points="1535.5,-394 1182.5,-394 1182.5,-370 1535.5,-370 1535.5,-394"/>
<text text-anchor="middle" x="1359" y="-379.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge51" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1001.46,-548.82C1027.35,-518.15 1100.35,-437.72 1181,-403 1186.06,-400.82 1191.28,-398.84 1196.6,-397.05"/>
<polygon fill="#000000" stroke="#000000" points="1197.79,-400.34 1206.28,-394.01 1195.7,-393.66 1197.79,-400.34"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node32" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i1</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node32"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i1">
<polygon fill="#d9534f" stroke="#d9534f" points="1535.5,-520 1182.5,-520 1182.5,-496 1535.5,-496 1535.5,-520"/>
<text text-anchor="middle" x="1359" y="-505.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge52" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1058.03,-548.94C1094.31,-542.58 1140.05,-534.88 1181,-529 1199.78,-526.3 1219.72,-523.69 1239.18,-521.28"/>
<polygon fill="#000000" stroke="#000000" points="1239.81,-524.73 1249.31,-520.04 1238.95,-517.78 1239.81,-524.73"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node33" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i2</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node33"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i2.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i2">
<polygon fill="#d9534f" stroke="#d9534f" points="1535.5,-856 1182.5,-856 1182.5,-832 1535.5,-832 1535.5,-856"/>
<text text-anchor="middle" x="1359" y="-841.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i2</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i2 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge53" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1117.08,-573.15C1127.47,-578.13 1137.03,-584.62 1145,-593 1216.3,-667.98 1106.49,-751.21 1181,-823 1181.84,-823.81 1182.68,-824.59 1183.55,-825.36"/>
<polygon fill="#000000" stroke="#000000" points="1181.63,-828.3 1191.64,-831.77 1185.97,-822.82 1181.63,-828.3"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node34" class="node">
<title>proc~dyn_mpas_get_variable_pointer_i3</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node34"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_i3.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i3">
<polygon fill="#d9534f" stroke="#d9534f" points="1535.5,-814 1182.5,-814 1182.5,-790 1535.5,-790 1535.5,-814"/>
<text text-anchor="middle" x="1359" y="-799.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_i3</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i3 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge54" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_i3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1116.04,-573.09C1126.78,-578.06 1136.7,-584.56 1145,-593 1204.66,-653.65 1118.74,-723.02 1181,-781 1181.99,-781.92 1182.99,-782.81 1184.01,-783.68"/>
<polygon fill="#000000" stroke="#000000" points="1182.08,-786.61 1192.16,-789.88 1186.32,-781.04 1182.08,-786.61"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node35" class="node">
<title>proc~dyn_mpas_get_variable_pointer_l0</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node35"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_l0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_l0">
<polygon fill="#d9534f" stroke="#d9534f" points="1535.5,-352 1182.5,-352 1182.5,-328 1535.5,-328 1535.5,-352"/>
<text text-anchor="middle" x="1359" y="-337.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_l0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_l0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge55" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_l0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M998.65,-548.83C1020.55,-512.79 1090.8,-406.28 1181,-361 1184.81,-359.09 1188.73,-357.32 1192.72,-355.69"/>
<polygon fill="#000000" stroke="#000000" points="1194.06,-358.92 1202.18,-352.12 1191.58,-352.37 1194.06,-358.92"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node36" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r0</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node36"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r0.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r0">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-436 1181.5,-436 1181.5,-412 1536.5,-412 1536.5,-436"/>
<text text-anchor="middle" x="1359" y="-421.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r0</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r0 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge56" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r0</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1006.08,-548.95C1036.43,-524.6 1109.57,-469.76 1181,-445 1187.93,-442.6 1195.1,-440.46 1202.4,-438.56"/>
<polygon fill="#000000" stroke="#000000" points="1203.55,-441.88 1212.43,-436.11 1201.89,-435.08 1203.55,-441.88"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node37" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r1</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node37"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r1.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r1">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-772 1181.5,-772 1181.5,-748 1536.5,-748 1536.5,-772"/>
<text text-anchor="middle" x="1359" y="-757.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r1</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r1 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge57" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r1</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1114.47,-573.05C1125.72,-577.99 1136.18,-584.5 1145,-593 1193.11,-639.39 1130.91,-694.75 1181,-739 1182.16,-740.02 1183.34,-741.02 1184.54,-741.98"/>
<polygon fill="#000000" stroke="#000000" points="1182.61,-744.89 1192.77,-747.88 1186.69,-739.21 1182.61,-744.89"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node38" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r2</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node38"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r2.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r2">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-730 1181.5,-730 1181.5,-706 1536.5,-706 1536.5,-730"/>
<text text-anchor="middle" x="1359" y="-715.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r2</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r2 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge58" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r2</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1111.79,-573.11C1123.9,-577.99 1135.29,-584.46 1145,-593 1181.72,-625.31 1142.9,-666.33 1181,-697 1182.41,-698.13 1183.85,-699.23 1185.31,-700.28"/>
<polygon fill="#000000" stroke="#000000" points="1183.66,-703.38 1193.95,-705.89 1187.47,-697.51 1183.66,-703.38"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node39" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r3</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node39"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r3.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r3">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-688 1181.5,-688 1181.5,-664 1536.5,-664 1536.5,-688"/>
<text text-anchor="middle" x="1359" y="-673.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r3</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r3 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge59" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r3</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1104.73,-573.13C1119.1,-577.88 1132.97,-584.32 1145,-593 1170.84,-611.65 1154.37,-637.5 1181,-655 1183.21,-656.45 1185.46,-657.83 1187.76,-659.13"/>
<polygon fill="#000000" stroke="#000000" points="1186.35,-662.34 1196.84,-663.83 1189.57,-656.13 1186.35,-662.34"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node40" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r4</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node40"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r4.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r4">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-646 1181.5,-646 1181.5,-622 1536.5,-622 1536.5,-646"/>
<text text-anchor="middle" x="1359" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r4</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r4 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge60" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r4</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1072.06,-573.06C1095.96,-577.89 1121.91,-584.41 1145,-593 1162.15,-599.38 1163.58,-607.37 1181,-613 1188.75,-615.5 1196.77,-617.71 1204.93,-619.67"/>
<polygon fill="#000000" stroke="#000000" points="1204.42,-623.14 1214.94,-621.92 1205.96,-616.31 1204.42,-623.14"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node41" class="node">
<title>proc~dyn_mpas_get_variable_pointer_r5</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node41"><a xlink:href="../proc/dyn_mpas_get_variable_pointer_r5.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r5">
<polygon fill="#d9534f" stroke="#d9534f" points="1536.5,-604 1181.5,-604 1181.5,-580 1536.5,-580 1536.5,-604"/>
<text text-anchor="middle" x="1359" y="-589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_variable_pointer_r5</text>
</a>
</g>
</g>
<!-- none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r5 -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge61" class="edge">
<title>none~get_variable_pointer&#45;&gt;proc~dyn_mpas_get_variable_pointer_r5</title>
<path fill="none" stroke="#000000" stroke-dasharray="5,2" d="M1130.06,-572.72C1154.73,-574.81 1180.56,-576.99 1205.6,-579.11"/>
<polygon fill="#000000" stroke="#000000" points="1205.63,-582.62 1215.89,-579.98 1206.22,-575.65 1205.63,-582.62"/>
</g>
<!-- proc~dyn_mpas_compute_edge_wind&#45;&gt;none~get_variable_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge62" class="edge">
<title>proc~dyn_mpas_compute_edge_wind&#45;&gt;none~get_variable_pointer</title>
<path fill="none" stroke="#000000" d="M777.93,-146.07C785.79,-149.9 793.22,-154.5 800,-160 835.71,-188.97 817.61,-214.85 836,-257 883.46,-365.74 950.83,-490.8 977.74,-539.78"/>
<polygon fill="#000000" stroke="#000000" points="974.81,-541.72 982.71,-548.79 980.94,-538.34 974.81,-541.72"/>
</g>
<!-- proc~dyn_mpas_compute_edge_wind&#45;&gt;proc~dyn_mpas_exchange_halo -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge64" class="edge">
<title>proc~dyn_mpas_compute_edge_wind&#45;&gt;proc~dyn_mpas_exchange_halo</title>
<path fill="none" stroke="#000000" d="M733.37,-146.05C755.6,-149.65 778.71,-154.23 800,-160 856.06,-175.19 917.99,-202.07 955.31,-219.45"/>
<polygon fill="#000000" stroke="#000000" points="954.17,-222.78 964.7,-223.87 957.14,-216.45 954.17,-222.78"/>
</g>
<!-- proc~dyn_mpas_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node28" class="node">
<title>proc~dyn_mpas_debug_print</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node28"><a xlink:href="../proc/dyn_mpas_debug_print.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_debug_print">
<polygon fill="#d9534f" stroke="#d9534f" points="1505,-146 1213,-146 1213,-122 1505,-122 1505,-146"/>
<text text-anchor="middle" x="1359" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_debug_print</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_compute_edge_wind&#45;&gt;proc~dyn_mpas_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge63" class="edge">
<title>proc~dyn_mpas_compute_edge_wind&#45;&gt;proc~dyn_mpas_debug_print</title>
<path fill="none" stroke="#000000" d="M793.55,-134C916.8,-134 1082.9,-134 1202.98,-134"/>
<polygon fill="#000000" stroke="#000000" points="1202.99,-137.5 1212.99,-134 1202.99,-130.5 1202.99,-137.5"/>
</g>
<!-- mpas_dmpar_exch_halo_field -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node25" class="node">
<title>mpas_dmpar_exch_halo_field</title>
<polygon fill="#777777" stroke="#777777" points="1443.5,-188 1274.5,-188 1274.5,-164 1443.5,-164 1443.5,-188"/>
<text text-anchor="middle" x="1359" y="-173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dmpar_exch_halo_field</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_dmpar_exch_halo_field -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge65" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_dmpar_exch_halo_field</title>
<path fill="none" stroke="#000000" d="M1055.88,-223.93C1092.51,-217.19 1139.27,-208.81 1181,-202 1207.91,-197.61 1237.18,-193.17 1264.02,-189.24"/>
<polygon fill="#000000" stroke="#000000" points="1264.79,-192.66 1274.18,-187.76 1263.78,-185.74 1264.79,-192.66"/>
</g>
<!-- mpas_pool_get_field -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node26" class="node">
<title>mpas_pool_get_field</title>
<polygon fill="#777777" stroke="#777777" points="1419.5,-310 1298.5,-310 1298.5,-286 1419.5,-286 1419.5,-310"/>
<text text-anchor="middle" x="1359" y="-295.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_field</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge66" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field</title>
<path fill="none" stroke="#000000" d="M1041.12,-248.09C1079.21,-257.04 1133.19,-269.01 1181,-277 1216.11,-282.87 1255.42,-287.7 1288.05,-291.25"/>
<polygon fill="#000000" stroke="#000000" points="1288.08,-294.77 1298.4,-292.35 1288.82,-287.81 1288.08,-294.77"/>
</g>
<!-- mpas_pool_get_field_info -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node27" class="node">
<title>mpas_pool_get_field_info</title>
<polygon fill="#777777" stroke="#777777" points="1432.5,-268 1285.5,-268 1285.5,-244 1432.5,-244 1432.5,-268"/>
<text text-anchor="middle" x="1359" y="-253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_field_info</text>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field_info -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge67" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;mpas_pool_get_field_info</title>
<path fill="none" stroke="#000000" d="M1145.07,-244.38C1189.7,-246.82 1236.73,-249.38 1275.22,-251.48"/>
<polygon fill="#000000" stroke="#000000" points="1275.15,-254.98 1285.32,-252.03 1275.53,-247.99 1275.15,-254.98"/>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;proc~dyn_mpas_debug_print -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge68" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;proc~dyn_mpas_debug_print</title>
<path fill="none" stroke="#000000" d="M1013.79,-223.97C1048.47,-205.84 1117.92,-171.85 1181,-155 1191.19,-152.28 1201.8,-149.91 1212.54,-147.85"/>
<polygon fill="#000000" stroke="#000000" points="1213.22,-151.28 1222.43,-146.04 1211.96,-144.4 1213.22,-151.28"/>
</g>
<!-- proc~stringify -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node42" class="node">
<title>proc~stringify</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node42"><a xlink:href="../proc/stringify.html" xlink:title="stringify">
<polygon fill="#d94e8f" stroke="#d94e8f" points="1759.5,-187 1704.5,-187 1704.5,-163 1759.5,-163 1759.5,-187"/>
<text text-anchor="middle" x="1732" y="-172.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">stringify</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_exchange_halo&#45;&gt;proc~stringify -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge69" class="edge">
<title>proc~dyn_mpas_exchange_halo&#45;&gt;proc~stringify</title>
<path fill="none" stroke="#000000" d="M1145.06,-226.73C1254.44,-219.71 1404.88,-209.21 1537,-197 1591.76,-191.94 1655.03,-184.46 1694.03,-179.65"/>
<polygon fill="#000000" stroke="#000000" points="1694.87,-183.08 1704.36,-178.38 1694.01,-176.13 1694.87,-183.08"/>
</g>
<!-- proc~dyn_mpas_debug_print&#45;&gt;proc~stringify -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge70" class="edge">
<title>proc~dyn_mpas_debug_print&#45;&gt;proc~stringify</title>
<path fill="none" stroke="#000000" d="M1468.81,-146.02C1545.02,-154.45 1642.19,-165.19 1694.2,-170.93"/>
<polygon fill="#000000" stroke="#000000" points="1693.96,-174.43 1704.29,-172.05 1694.73,-167.47 1693.96,-174.43"/>
</g>
<!-- mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node43" class="node">
<title>mpas_pool_get_array</title>
<polygon fill="#777777" stroke="#777777" points="1795.5,-646 1668.5,-646 1668.5,-622 1795.5,-622 1795.5,-646"/>
<text text-anchor="middle" x="1732" y="-631.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_array</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge71" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1524.68,-478.06C1528.99,-480.72 1533.11,-483.69 1537,-487 1581.35,-524.76 1528.92,-574.93 1573,-613 1596.04,-632.9 1628.47,-639.57 1657.95,-640.71"/>
<polygon fill="#000000" stroke="#000000" points="1658.17,-644.22 1668.23,-640.9 1658.3,-637.22 1658.17,-644.22"/>
</g>
<!-- mpas_pool_get_config -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node44" class="node">
<title>mpas_pool_get_config</title>
<polygon fill="#777777" stroke="#777777" points="1797.5,-415 1666.5,-415 1666.5,-391 1797.5,-391 1797.5,-415"/>
<text text-anchor="middle" x="1732" y="-400.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_config</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge72" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1474.96,-453.97C1495.66,-451.35 1517.01,-448.34 1537,-445 1582.55,-437.38 1633.58,-426.23 1671.87,-417.33"/>
<polygon fill="#000000" stroke="#000000" points="1672.87,-420.69 1681.81,-415 1671.28,-413.88 1672.87,-420.69"/>
</g>
<!-- proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node46" class="node">
<title>proc~dyn_mpas_get_pool_pointer</title>
<g id="a_proc~~set_analytic_initial_condition~~CallsGraph_node46"><a xlink:href="../proc/dyn_mpas_get_pool_pointer.html" xlink:title="mpas_dynamical_core_type%dyn_mpas_get_pool_pointer">
<polygon fill="#d9534f" stroke="#d9534f" points="1891,-604 1573,-604 1573,-580 1891,-580 1891,-604"/>
<text text-anchor="middle" x="1732" y="-589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_dynamical_core_type%dyn_mpas_get_pool_pointer</text>
</a>
</g>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge73" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1502.07,-478.02C1514.01,-480.48 1525.79,-483.45 1537,-487 1601.78,-507.54 1669.97,-550.06 1705.72,-574.22"/>
<polygon fill="#000000" stroke="#000000" points="1703.85,-577.18 1714.08,-579.94 1707.8,-571.4 1703.85,-577.18"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge74" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1516.92,-562.03C1523.85,-564.61 1530.58,-567.58 1537,-571 1558.69,-582.57 1551.39,-601.27 1573,-613 1598.67,-626.93 1630.03,-632.94 1658.02,-635.2"/>
<polygon fill="#000000" stroke="#000000" points="1657.96,-638.7 1668.17,-635.87 1658.42,-631.72 1657.96,-638.7"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge75" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_c1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1466.31,-562.04C1512.79,-567.3 1567.43,-573.48 1614.96,-578.86"/>
<polygon fill="#000000" stroke="#000000" points="1614.66,-582.35 1624.99,-580 1615.45,-575.4 1614.66,-582.35"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge76" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1525.92,-394.03C1529.82,-396.72 1533.52,-399.7 1537,-403 1605.67,-468.21 1504.79,-547.31 1573,-613 1595.29,-634.47 1628.27,-641.19 1658.34,-641.95"/>
<polygon fill="#000000" stroke="#000000" points="1658.39,-645.45 1668.4,-641.99 1658.42,-638.45 1658.39,-645.45"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge77" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1535.72,-391.95C1578.17,-394.35 1621.3,-396.79 1656.19,-398.77"/>
<polygon fill="#000000" stroke="#000000" points="1656.09,-402.27 1666.27,-399.34 1656.49,-395.28 1656.09,-402.27"/>
</g>
<!-- mpas_pool_get_dimension -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node45" class="node">
<title>mpas_pool_get_dimension</title>
<polygon fill="#777777" stroke="#777777" points="1809,-489 1655,-489 1655,-465 1809,-465 1809,-489"/>
<text text-anchor="middle" x="1732" y="-474.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_dimension</text>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_dimension -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge78" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;mpas_pool_get_dimension</title>
<path fill="none" stroke="#000000" d="M1504.08,-394.03C1515.34,-396.51 1526.44,-399.46 1537,-403 1554.56,-408.88 1556.13,-416.35 1573,-424 1606.76,-439.31 1646.31,-452.58 1677.39,-462"/>
<polygon fill="#000000" stroke="#000000" points="1676.58,-465.42 1687.17,-464.93 1678.59,-458.71 1676.58,-465.42"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge79" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1523.52,-394.04C1528.22,-396.69 1532.73,-399.67 1537,-403 1572.58,-430.8 1543.98,-463.41 1573,-498 1603.85,-534.76 1652.97,-560.77 1688.25,-575.97"/>
<polygon fill="#000000" stroke="#000000" points="1687.23,-579.34 1697.81,-579.97 1689.94,-572.88 1687.23,-579.34"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge80" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1522.93,-520.05C1527.83,-522.69 1532.54,-525.66 1537,-529 1569.53,-553.32 1540.64,-588.45 1573,-613 1596.96,-631.18 1629.05,-637.71 1658.06,-639.2"/>
<polygon fill="#000000" stroke="#000000" points="1658.06,-642.7 1668.17,-639.53 1658.29,-635.71 1658.06,-642.7"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_dimension -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge81" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;mpas_pool_get_dimension</title>
<path fill="none" stroke="#000000" d="M1503.7,-495.99C1551.34,-492.01 1602.85,-487.71 1644.77,-484.21"/>
<polygon fill="#000000" stroke="#000000" points="1645.26,-487.68 1654.94,-483.36 1644.68,-480.7 1645.26,-487.68"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge82" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1487.16,-520.04C1504.01,-522.52 1520.98,-525.48 1537,-529 1591.37,-540.93 1652.11,-561.96 1690.9,-576.42"/>
<polygon fill="#000000" stroke="#000000" points="1689.68,-579.7 1700.27,-579.94 1692.14,-573.15 1689.68,-579.7"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge83" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1514.31,-832C1522.13,-829.44 1529.74,-826.46 1537,-823 1619.46,-783.65 1688.51,-695.15 1717,-654.78"/>
<polygon fill="#000000" stroke="#000000" points="1719.92,-656.7 1722.75,-646.49 1714.17,-652.71 1719.92,-656.7"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge84" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i2&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1525.92,-831.97C1529.82,-829.28 1533.52,-826.3 1537,-823 1605.67,-757.79 1504.79,-678.69 1573,-613 1573.95,-612.08 1574.93,-611.19 1575.92,-610.33"/>
<polygon fill="#000000" stroke="#000000" points="1578.08,-613.08 1583.86,-604.2 1573.8,-607.54 1578.08,-613.08"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge85" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1510.15,-789.91C1519.37,-787.42 1528.39,-784.47 1537,-781 1610.65,-751.3 1680.72,-685.99 1712.77,-653.35"/>
<polygon fill="#000000" stroke="#000000" points="1715.28,-655.79 1719.73,-646.17 1710.26,-650.92 1715.28,-655.79"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge86" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_i3&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1525.74,-789.77C1529.69,-787.15 1533.45,-784.23 1537,-781 1593.45,-729.57 1516.92,-664.82 1573,-613 1574,-612.08 1575.02,-611.18 1576.06,-610.31"/>
<polygon fill="#000000" stroke="#000000" points="1578.41,-612.92 1584.38,-604.16 1574.25,-607.29 1578.41,-612.92"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge87" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1474.96,-352.03C1495.66,-354.65 1517.01,-357.66 1537,-361 1582.55,-368.62 1633.58,-379.77 1671.87,-388.67"/>
<polygon fill="#000000" stroke="#000000" points="1671.28,-392.12 1681.81,-391 1672.87,-385.31 1671.28,-392.12"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge88" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_l0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1525.16,-352.2C1529.3,-354.82 1533.26,-357.75 1537,-361 1584.5,-402.32 1535.12,-447.71 1573,-498 1601.44,-535.75 1649.84,-561.28 1685.6,-576.1"/>
<polygon fill="#000000" stroke="#000000" points="1684.73,-579.52 1695.32,-579.99 1687.34,-573.02 1684.73,-579.52"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge89" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1525.74,-436.23C1529.69,-438.85 1533.45,-441.77 1537,-445 1593.45,-496.43 1516.92,-561.18 1573,-613 1595.64,-633.92 1628.5,-640.61 1658.39,-641.49"/>
<polygon fill="#000000" stroke="#000000" points="1658.37,-644.99 1668.4,-641.58 1658.43,-637.99 1658.37,-644.99"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_config -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge90" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;mpas_pool_get_config</title>
<path fill="none" stroke="#000000" d="M1536.54,-414.01C1578.7,-411.62 1621.48,-409.2 1656.14,-407.24"/>
<polygon fill="#000000" stroke="#000000" points="1656.38,-410.73 1666.16,-406.67 1655.98,-403.74 1656.38,-410.73"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge91" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r0&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1519.58,-436.07C1525.61,-438.66 1531.45,-441.62 1537,-445 1561.33,-459.79 1552.27,-478.48 1573,-498 1609.11,-532 1659.59,-559.36 1693.7,-575.61"/>
<polygon fill="#000000" stroke="#000000" points="1692.32,-578.83 1702.86,-579.9 1695.29,-572.49 1692.32,-578.83"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge92" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1502.07,-747.98C1514.01,-745.52 1525.79,-742.55 1537,-739 1601.78,-718.46 1669.97,-675.94 1705.72,-651.78"/>
<polygon fill="#000000" stroke="#000000" points="1707.8,-654.6 1714.08,-646.06 1703.85,-648.82 1707.8,-654.6"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge93" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r1&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1524.68,-747.94C1528.99,-745.28 1533.11,-742.31 1537,-739 1581.35,-701.24 1528.92,-651.07 1573,-613 1574.33,-611.85 1575.7,-610.74 1577.09,-609.68"/>
<polygon fill="#000000" stroke="#000000" points="1579.06,-612.57 1585.36,-604.05 1575.12,-606.78 1579.06,-612.57"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge94" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1487.16,-705.96C1504.01,-703.48 1520.98,-700.52 1537,-697 1591.37,-685.07 1652.11,-664.04 1690.9,-649.58"/>
<polygon fill="#000000" stroke="#000000" points="1692.14,-652.85 1700.27,-646.06 1689.68,-646.3 1692.14,-652.85"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge95" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r2&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1522.93,-705.95C1527.83,-703.31 1532.54,-700.34 1537,-697 1569.53,-672.68 1540.64,-637.55 1573,-613 1574.65,-611.75 1576.35,-610.55 1578.07,-609.4"/>
<polygon fill="#000000" stroke="#000000" points="1580.17,-612.22 1586.98,-604.11 1576.6,-606.21 1580.17,-612.22"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge96" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1466.31,-663.96C1527.89,-656.99 1603.81,-648.4 1658.52,-642.2"/>
<polygon fill="#000000" stroke="#000000" points="1658.94,-645.68 1668.49,-641.08 1658.15,-638.72 1658.94,-645.68"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge97" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r3&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1516.92,-663.97C1523.85,-661.39 1530.58,-658.42 1537,-655 1558.69,-643.43 1551.39,-624.73 1573,-613 1576.36,-611.18 1579.82,-609.49 1583.35,-607.93"/>
<polygon fill="#000000" stroke="#000000" points="1584.91,-611.07 1592.87,-604.08 1582.29,-604.58 1584.91,-611.07"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge98" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1536.54,-634C1579.55,-634 1623.21,-634 1658.23,-634"/>
<polygon fill="#000000" stroke="#000000" points="1658.34,-637.5 1668.34,-634 1658.34,-630.5 1658.34,-637.5"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge99" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r4&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1466.31,-621.96C1512.79,-616.7 1567.43,-610.52 1614.96,-605.14"/>
<polygon fill="#000000" stroke="#000000" points="1615.45,-608.6 1624.99,-604 1614.66,-601.65 1615.45,-608.6"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;mpas_pool_get_array -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge100" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;mpas_pool_get_array</title>
<path fill="none" stroke="#000000" d="M1466.31,-604.04C1527.89,-611.01 1603.81,-619.6 1658.52,-625.8"/>
<polygon fill="#000000" stroke="#000000" points="1658.15,-629.28 1668.49,-626.92 1658.94,-622.32 1658.15,-629.28"/>
</g>
<!-- proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;proc~dyn_mpas_get_pool_pointer -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge101" class="edge">
<title>proc~dyn_mpas_get_variable_pointer_r5&#45;&gt;proc~dyn_mpas_get_pool_pointer</title>
<path fill="none" stroke="#000000" d="M1536.54,-592C1545.26,-592 1554.02,-592 1562.72,-592"/>
<polygon fill="#000000" stroke="#000000" points="1562.91,-595.5 1572.91,-592 1562.91,-588.5 1562.91,-595.5"/>
</g>
<!-- mpas_pool_get_subpool -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_node47" class="node">
<title>mpas_pool_get_subpool</title>
<polygon fill="#777777" stroke="#777777" points="2067,-604 1927,-604 1927,-580 2067,-580 2067,-604"/>
<text text-anchor="middle" x="1997" y="-589.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">mpas_pool_get_subpool</text>
</g>
<!-- proc~dyn_mpas_get_pool_pointer&#45;&gt;mpas_pool_get_subpool -->
<g id="proc~~set_analytic_initial_condition~~CallsGraph_edge102" class="edge">
<title>proc~dyn_mpas_get_pool_pointer&#45;&gt;mpas_pool_get_subpool</title>
<path fill="none" stroke="#000000" d="M1891.3,-592C1899.94,-592 1908.43,-592 1916.59,-592"/>
<polygon fill="#000000" stroke="#000000" points="1916.75,-595.5 1926.75,-592 1916.75,-588.5 1916.75,-595.5"/>
</g>
</g>
</svg>
</div>                <script>
                  var panprocset_analytic_initial_conditionCallsGraph = svgPanZoom('#procset_analytic_initial_conditionCallsGraph',
                    {zoomEnabled: true, controlIconsEnabled: true, fit: true, center: true,}
                  );
                </script>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CallsGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CallsGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div></div>
        </div>
        <div class="card">
          <div class="card-header">
            <h3 class="card-title">Called by</h3>
          </div>
          <div class="card-body"><div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proc~~set_analytic_initial_condition~~CalledByGraph Pages: 1 -->
<svg id="procset_analytic_initial_conditionCalledByGraph" width="263pt" height="32pt"
 viewBox="0.00 0.00 263.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~set_analytic_initial_condition~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~set_analytic_initial_condition~~CalledByGraph</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 259,-28 259,4 -4,4"/>
<!-- proc~set_analytic_initial_condition -->
<g id="proc~~set_analytic_initial_condition~~CalledByGraph_node1" class="node">
<title>proc~set_analytic_initial_condition</title>
<polygon fill="none" stroke="black" points="255,-24 90,-24 90,0 255,0 255,-24"/>
<text text-anchor="middle" x="172.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">set_analytic_initial_condition</text>
</g>
<!-- proc~dyn_init -->
<g id="proc~~set_analytic_initial_condition~~CalledByGraph_node2" class="node">
<title>proc~dyn_init</title>
<g id="a_proc~~set_analytic_initial_condition~~CalledByGraph_node2"><a xlink:href="../proc/dyn_init.html" xlink:title="dyn_init">
<polygon fill="#d9534f" stroke="#d9534f" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">dyn_init</text>
</a>
</g>
</g>
<!-- proc~dyn_init&#45;&gt;proc~set_analytic_initial_condition -->
<g id="proc~~set_analytic_initial_condition~~CalledByGraph_edge1" class="edge">
<title>proc~dyn_init&#45;&gt;proc~set_analytic_initial_condition</title>
<path fill="none" stroke="#000000" d="M54.32,-12C61.87,-12 70.55,-12 79.71,-12"/>
<polygon fill="#000000" stroke="#000000" points="79.8,-15.5 89.8,-12 79.8,-8.5 79.8,-15.5"/>
</g>
</g>
</svg>
</div>          <div>
            <a type="button" class="graph-help" data-bs-toggle="modal" href="#CalledByGraph-help-text">Help</a>
          </div>
          <div class="modal fade" id="CalledByGraph-help-text" tabindex="-1" role="dialog">
            <div class="modal-dialog modal-lg" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h4 class="modal-title" id="-graph-help-label">Graph Key</h4>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
<p>Nodes of different colours represent the following: </p>
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="641pt" height="28pt"
 viewBox="0.00 0.00 641.00 27.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.86 0.86) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-28 741.5,-28 741.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="70,-24 0,-24 0,0 70,0 70,-24"/>
<text text-anchor="middle" x="35" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="146,-24 88,-24 88,0 146,0 146,-24"/>
<text text-anchor="middle" x="117" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="225.5,-24 164.5,-24 164.5,0 225.5,0 225.5,-24"/>
<text text-anchor="middle" x="195" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Interface</text>
</g>
<!-- Type Bound Procedure -->
<g id="node4" class="node">
<title>Type Bound Procedure</title>
<polygon fill="#a7506f" stroke="#a7506f" points="374,-24 244,-24 244,0 374,0 374,-24"/>
<text text-anchor="middle" x="309" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Type Bound Procedure</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node5" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="537.5,-24 392.5,-24 392.5,0 537.5,0 537.5,-24"/>
<text text-anchor="middle" x="465" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node6" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="614,-24 556,-24 556,0 614,0 614,-24"/>
<text text-anchor="middle" x="585" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="white">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node7" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="black" points="737.5,-24 632.5,-24 632.5,0 737.5,0 737.5,-24"/>
<text text-anchor="middle" x="685" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50">This Page&#39;s Entity</text>
</g>
</g>
</svg>

<p>Solid arrows point from a procedure to one which it calls. Dashed 
arrows point from an interface to procedures which implement that interface.
This could include the module procedures in a generic interface or the
implementation in a submodule of an interface in a parent module.
</p>
 </div>
            </div>
          </div>
        </div></div>
        </div>
      <br>


        <section>
          <h2>Variables</h2>
            <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Visibility</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
<th></th><th scope="col">Initial</th>        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-buffer_2d_real"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>buffer_2d_real</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-buffer_3d_real"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>buffer_3d_real</strong>(:,:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-global_grid_index"></span>
              integer,
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>global_grid_index</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lat_rad"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>lat_rad</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lon_rad"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>lon_rad</strong>(:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-subname~4"></span>
              character(len=*),
            </td>
              <td>private,</td>
            <td>
parameter               
            </td>
            <td>::</td>
            <td><strong>subname</strong></td>
<td> =</td>
                <td>&#39;dyn_comp::set_analytic_initial_condition&#39;</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z_int"></span>
              real(kind=kind_r8),
            </td>
              <td>private,</td>
            <td>
              allocatable
            </td>
            <td>::</td>
            <td><strong>z_int</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-zgrid~2"></span>
              real(kind=kind_dyn_mpas),
            </td>
              <td>private,</td>
            <td>
              pointer
            </td>
            <td>::</td>
            <td><strong>zgrid</strong>(:,:)</td>
                <td></td>
                <td></td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

        </section>
        <br>





        <section>
          <h2>Functions</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-p_by_hypsometric_equation"></span> <h3>pure elemental function <a href='set_analytic_initial_condition.html#proc-p_by_hypsometric_equation'>p_by_hypsometric_equation</a>(p_1, z_1, t_v, z_2) result(p_2)  
</h3></div>
    <div class="card-body">
          
  <p>Compute the pressure <code>p_2</code> at height <code>z_2</code> from the pressure <code>p_1</code> at height <code>z_1</code> by hypsometric equation.
<code>t_v</code> is the mean virtual temperature between <code>z_1</code> and <code>z_2</code>. Essentially,
<script type="math/tex"> P_2 = P_1 e^{\frac{-(z_2 - z_1) g}{R_d T_v}} </script>.
(KCW, 2024-07-02)</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-p_1"></span>
              real(kind=kind_r8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>p_1</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z_1"></span>
              real(kind=kind_r8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>z_1</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-t_v"></span>
              real(kind=kind_r8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>t_v</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-z_2"></span>
              real(kind=kind_r8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>z_2</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind_r8)</small>
    </h4>
    

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-theta_by_poisson_equation"></span> <h3>pure elemental function <a href='set_analytic_initial_condition.html#proc-theta_by_poisson_equation'>theta_by_poisson_equation</a>(p_1, t_1, p_0) result(t_0)  
</h3></div>
    <div class="card-body">
          
  <p>Compute the potential temperature <code>t_0</code> at reference pressure <code>p_0</code> from the temperature <code>t_1</code> at pressure <code>p_1</code> by
Poisson equation. Essentially,
<script type="math/tex"> \theta = T (\frac{P_0}{P})^{\frac{R_d}{C_p}} </script>.
(KCW, 2024-07-02)</p>

  <h4>Arguments</h4>
      <table class="table table-striped varlist">
    <thead>
      <tr>
        <th scope="col">Type</th>
<th scope="col">Intent</th><th scope="col">Optional</th>        <th scope="col">Attributes</th>
        <th scope="col"></th>
        <th scope="col">Name</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-p_1~2"></span>
              real(kind=kind_r8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>p_1</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-t_1"></span>
              real(kind=kind_r8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>t_1</strong></td>
            <td>

            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-p_0"></span>
              real(kind=kind_r8),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>p_0</strong></td>
            <td>

            </td>
        </tr>
    </tbody>
  </table>

    <h4>
    Return Value
    <small>real(kind=kind_r8)</small>
    </h4>
    

    </div>
  </div>

        </section>
        <br>

        <section>
          <h2>Subroutines</h2>
              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-final_shared_variables"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-final_shared_variables'>final_shared_variables</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Finalize variables that are shared and repeatedly used by the <code>set_mpas_state_*</code> internal subroutines.
(KCW, 2024-05-13)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-init_shared_variables"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-init_shared_variables'>init_shared_variables</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Initialize variables that are shared and repeatedly used by the <code>set_mpas_state_*</code> internal subroutines.
(KCW, 2024-05-13)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_mpas_state_rho_base_theta_base"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-set_mpas_state_rho_base_theta_base'>set_mpas_state_rho_base_theta_base</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set MPAS state <code>rho_base</code> (i.e., base state dry air density) and <code>theta_base</code> (i.e., base state potential temperature).
(KCW, 2024-05-21)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_mpas_state_rho_theta"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-set_mpas_state_rho_theta'>set_mpas_state_rho_theta</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set MPAS state <code>rho</code> (i.e., dry air density) and <code>theta</code> (i.e., potential temperature).
(KCW, 2024-05-19)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_mpas_state_scalars"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-set_mpas_state_scalars'>set_mpas_state_scalars</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set MPAS state <code>scalars</code> (i.e., constituents).
(KCW, 2024-05-17)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_mpas_state_u"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-set_mpas_state_u'>set_mpas_state_u</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set MPAS state <code>u</code> (i.e., horizontal velocity at edge interfaces).
(KCW, 2024-05-13)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

              <div class="card">
    <div class="card-header codesum"><span class="anchor" id="proc-set_mpas_state_w"></span> <h3> subroutine <a href='set_analytic_initial_condition.html#proc-set_mpas_state_w'>set_mpas_state_w</a>()  
</h3></div>
    <div class="card-body">
          
  <p>Set MPAS state <code>w</code> (i.e., vertical velocity at cell interfaces).
(KCW, 2024-05-13)</p>

  <h4>Arguments</h4>
    <em>None</em>

    </div>
  </div>

        </section>


        <section>
          <h2><span class="anchor" id="src"></span>Source Code</h2>
          <div class="hl codehilite"><pre><span></span><span class="w">    </span><span class="k">subroutine </span><span class="n">set_analytic_initial_condition</span><span class="p">()</span>
<span class="w">        </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">        </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_debug</span>
<span class="w">        </span><span class="c">! Module(s) from CESM Share.</span>
<span class="w">        </span><span class="k">use </span><span class="n">shr_kind_mod</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">kind_r8</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">shr_kind_r8</span>

<span class="w">        </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition&#39;</span>
<span class="w">        </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">(:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">buffer_2d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">buffer_3d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">(:),</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">(:)</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">z_int</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">   </span><span class="c">! Geometric height (m) at layer interfaces.</span>
<span class="w">                                                    </span><span class="c">! Dimension and vertical index orders follow CAM-SIMA convention.</span>
<span class="w">        </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="c">! Geometric height (m) at layer interfaces.</span>
<span class="w">                                                    </span><span class="c">! Dimension and vertical index orders follow MPAS convention.</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_debug</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39; entered&#39;</span><span class="p">)</span>

<span class="w">        </span><span class="k">call </span><span class="n">init_shared_variables</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">set_mpas_state_u</span><span class="p">()</span>
<span class="w">        </span><span class="k">call </span><span class="n">set_mpas_state_w</span><span class="p">()</span>
<span class="w">        </span><span class="k">call </span><span class="n">set_mpas_state_scalars</span><span class="p">()</span>
<span class="w">        </span><span class="k">call </span><span class="n">set_mpas_state_rho_theta</span><span class="p">()</span>
<span class="w">        </span><span class="k">call </span><span class="n">set_mpas_state_rho_base_theta_base</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">final_shared_variables</span><span class="p">()</span>

<span class="w">        </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_debug</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="s1">&#39; completed&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="k">contains</span>
<span class="w">        </span><span class="c">!&gt; Initialize variables that are shared and repeatedly used by the `set_mpas_state_*` internal subroutines.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-13)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">init_shared_variables</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span><span class="p">,</span><span class="w"> </span><span class="n">endrun</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_grid_support</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">cam_grid_get_latvals</span><span class="p">,</span><span class="w"> </span><span class="n">cam_grid_get_lonvals</span><span class="p">,</span><span class="w"> </span><span class="n">cam_grid_id</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">deg_to_rad</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pverp</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::init_shared_variables&#39;</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">indextocellid</span><span class="p">(:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">lat_deg</span><span class="p">(:),</span><span class="w"> </span><span class="n">lon_deg</span><span class="p">(:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Preparing to set analytic initial condition&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zgrid</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">indextocellid</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">lat_deg</span><span class="p">,</span><span class="w"> </span><span class="n">lon_deg</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">global_grid_index</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;global_grid_index(ncells_solve)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">indextocellid</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;indexToCellID&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="n">global_grid_index</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">indextocellid</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">ncells_solve</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">indextocellid</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">lat_rad</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;lat_rad(ncells_solve)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">lon_rad</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;lon_rad(ncells_solve)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="c">! &quot;mpas_cell&quot; is a registered grid name that is defined in `dyn_grid`.</span>
<span class="w">            </span><span class="n">lat_deg</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cam_grid_get_latvals</span><span class="p">(</span><span class="n">cam_grid_id</span><span class="p">(</span><span class="s1">&#39;mpas_cell&#39;</span><span class="p">))</span>
<span class="w">            </span><span class="n">lon_deg</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cam_grid_get_lonvals</span><span class="p">(</span><span class="n">cam_grid_id</span><span class="p">(</span><span class="s1">&#39;mpas_cell&#39;</span><span class="p">))</span>

<span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">lat_deg</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to find variable &quot;lat_deg&quot;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(.</span><span class="nb">not</span><span class="p">.</span><span class="w"> </span><span class="nb">associated</span><span class="p">(</span><span class="n">lon_deg</span><span class="p">))</span><span class="w"> </span><span class="k">then</span>
<span class="k">                call </span><span class="n">endrun</span><span class="p">(</span><span class="s1">&#39;Failed to find variable &quot;lon_deg&quot;&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            </span><span class="n">lat_rad</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lat_deg</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">deg_to_rad</span>
<span class="w">            </span><span class="n">lon_rad</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lon_deg</span><span class="p">(:)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">deg_to_rad</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">lat_deg</span><span class="p">,</span><span class="w"> </span><span class="n">lon_deg</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">z_int</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pverp</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;z_int(ncells_solve, pverp)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">zgrid</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;zgrid&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">z_int</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">))</span>
<span class="w">            </span><span class="k">end do</span>
<span class="k">        end subroutine </span><span class="n">init_shared_variables</span>

<span class="w">        </span><span class="c">!&gt; Finalize variables that are shared and repeatedly used by the `set_mpas_state_*` internal subroutines.</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-13)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">final_shared_variables</span><span class="p">()</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::final_shared_variables&#39;</span>

<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">global_grid_index</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">z_int</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zgrid</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">final_shared_variables</span>

<span class="w">        </span><span class="c">!&gt; Set MPAS state `u` (i.e., horizontal velocity at edge interfaces).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-13)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_mpas_state_u</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_tests_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">vc_height</span>
<span class="w">            </span><span class="k">use </span><span class="n">inic_analytic</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dyn_set_inic_col</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::set_mpas_state_u&#39;</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ucellzonal</span><span class="p">(:,</span><span class="w"> </span><span class="p">:),</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting MPAS state &quot;u&quot;&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;buffer_2d_real(ncells_solve, pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;uReconstructZonal&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">ucellmeridional</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;uReconstructMeridional&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="n">buffer_2d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_r8</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_set_inic_col</span><span class="p">(</span><span class="n">vc_height</span><span class="p">,</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">,</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">,</span><span class="w"> </span><span class="n">zint</span><span class="o">=</span><span class="n">z_int</span><span class="p">,</span><span class="w"> </span><span class="n">u</span><span class="o">=</span><span class="n">buffer_2d_real</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">ucellzonal</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            </span><span class="n">buffer_2d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_r8</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_set_inic_col</span><span class="p">(</span><span class="n">vc_height</span><span class="p">,</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">,</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">,</span><span class="w"> </span><span class="n">zint</span><span class="o">=</span><span class="n">z_int</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="o">=</span><span class="n">buffer_2d_real</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">ucellmeridional</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:)),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">ucellzonal</span><span class="p">,</span><span class="w"> </span><span class="n">ucellmeridional</span><span class="p">)</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">compute_edge_wind</span><span class="p">(</span><span class="n">wind_tendency</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_mpas_state_u</span>

<span class="w">        </span><span class="c">!&gt; Set MPAS state `w` (i.e., vertical velocity at cell interfaces).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-13)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_mpas_state_w</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::set_mpas_state_w&#39;</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">w</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting MPAS state &quot;w&quot;&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">w</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="w">            </span><span class="n">w</span><span class="p">(:,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">ncells_solve</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_dyn_mpas</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Because we are injecting data directly into MPAS memory, halo layers need to be updated manually.</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_mpas_state_w</span>

<span class="w">        </span><span class="c">!&gt; Set MPAS state `scalars` (i.e., constituents).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-17)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_mpas_state_scalars</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_constituents</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_tests_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">vc_height</span>
<span class="w">            </span><span class="k">use </span><span class="n">inic_analytic</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dyn_set_inic_col</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span>

<span class="w">            </span><span class="c">! CCPP standard name of `qv`, which denotes water vapor mixing ratio.</span>
<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">constituent_qv_standard_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="s1">&#39;water_vapor_mixing_ratio_wrt_dry_air&#39;</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::set_mpas_state_scalars&#39;</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">j</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">constituent_index</span><span class="p">(:)</span>
<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">index_qv</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scalars</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting MPAS state &quot;scalars&quot;&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">buffer_3d_real</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;buffer_3d_real(ncells_solve, pver, num_advected)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">constituent_index</span><span class="p">(</span><span class="n">num_advected</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;constituent_index(num_advected)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dim&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;index_qv&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">scalars</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;scalars&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="w">            </span><span class="n">buffer_3d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_r8</span>
<span class="w">            </span><span class="n">constituent_index</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span><span class="p">)]</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_set_inic_col</span><span class="p">(</span><span class="n">vc_height</span><span class="p">,</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">,</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">,</span><span class="w"> </span><span class="n">zint</span><span class="o">=</span><span class="n">z_int</span><span class="p">,</span><span class="w"> </span><span class="n">q</span><span class="o">=</span><span class="n">buffer_3d_real</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">m_cnst</span><span class="o">=</span><span class="n">constituent_index</span><span class="p">)</span>

<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="c">! `j` is indexing into `scalars`, so it is regarded as MPAS scalar index.</span>
<span class="w">                </span><span class="k">do </span><span class="n">j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">num_advected</span>
<span class="w">                    </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">                    </span><span class="n">scalars</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="kt">real</span><span class="p">(</span><span class="n">reverse</span><span class="p">(</span><span class="n">buffer_3d_real</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">map_constituent_index</span><span class="p">(</span><span class="n">j</span><span class="p">))),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">                </span><span class="k">end do</span>
<span class="k">            end do</span>

<span class="k">            if</span><span class="w"> </span><span class="p">(</span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_constituent_name</span><span class="p">(</span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">map_constituent_index</span><span class="p">(</span><span class="n">index_qv</span><span class="p">))</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                </span><span class="n">constituent_qv_standard_name</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="w">                </span><span class="c">! The definition of `qv` matches exactly what MPAS wants. No conversion is needed.</span>
<span class="w">                </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;No conversion is needed for water vapor mixing ratio&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">else</span>
<span class="w">                </span><span class="c">! The definition of `qv` actually represents specific humidity. Conversion is needed.</span>
<span class="w">                </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Conversion is needed and applied for water vapor mixing ratio&#39;</span><span class="p">)</span>

<span class="w">                </span><span class="c">! Convert specific humidity to water vapor mixing ratio.</span>
<span class="w">                </span><span class="n">scalars</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">ncells_solve</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">scalars</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">ncells_solve</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0_kind_dyn_mpas</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">scalars</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="n">ncells_solve</span><span class="p">))</span>
<span class="w">            </span><span class="k">end if</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">buffer_3d_real</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">constituent_index</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Because we are injecting data directly into MPAS memory, halo layers need to be updated manually.</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;scalars&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_mpas_state_scalars</span>

<span class="w">        </span><span class="c">!&gt; Set MPAS state `rho` (i.e., dry air density) and `theta` (i.e., potential temperature).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-19)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_mpas_state_rho_theta</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>
<span class="w">            </span><span class="k">use </span><span class="n">dyn_tests_utils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">vc_height</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_p0</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">pref</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rair</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rv</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rh2o</span>
<span class="w">            </span><span class="k">use </span><span class="n">inic_analytic</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">dyn_set_inic_col</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::set_mpas_state_rho_theta&#39;</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">integer</span><span class="p">,</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">index_qv</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p_mid_col</span><span class="p">(:)</span><span class="w">  </span><span class="c">! Pressure (Pa) at layer midpoints of each column. This is full pressure,</span>
<span class="w">                                                        </span><span class="c">! which also accounts for water vapor.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p_sfc</span><span class="p">(:)</span><span class="w">      </span><span class="c">! Pressure (Pa) at surface. This is full pressure,</span>
<span class="w">                                                        </span><span class="c">! which also accounts for water vapor.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="c">! Water vapor mixing ratio (kg/kg) at layer midpoints of each column.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">t_mid</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w">   </span><span class="c">! Temperature (K) at layer midpoints.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="c">! Modified &quot;moist&quot; temperature (K) at layer midpoints of each column.</span>
<span class="w">                                                        </span><span class="c">! Be advised that it is not virtual temperature.</span>
<span class="w">                                                        </span><span class="c">! See doi:10.5065/1DFH-6P97 and doi:10.1175/MWR-D-11-00215.1 for details.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rho</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">theta</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">scalars</span><span class="p">(:,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting MPAS state &quot;rho&quot; and &quot;theta&quot;&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">p_sfc</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;p_sfc(ncells_solve)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="n">p_sfc</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_r8</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_set_inic_col</span><span class="p">(</span><span class="n">vc_height</span><span class="p">,</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">,</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">,</span><span class="w"> </span><span class="n">zint</span><span class="o">=</span><span class="n">z_int</span><span class="p">,</span><span class="w"> </span><span class="n">ps</span><span class="o">=</span><span class="n">p_sfc</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">(</span><span class="n">ncells_solve</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;buffer_2d_real(ncells_solve, pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">t_mid</span><span class="p">(</span><span class="n">pver</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;t_mid(pver, ncells_solve)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="n">buffer_2d_real</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0_kind_r8</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_set_inic_col</span><span class="p">(</span><span class="n">vc_height</span><span class="p">,</span><span class="w"> </span><span class="n">lat_rad</span><span class="p">,</span><span class="w"> </span><span class="n">lon_rad</span><span class="p">,</span><span class="w"> </span><span class="n">global_grid_index</span><span class="p">,</span><span class="w"> </span><span class="n">zint</span><span class="o">=</span><span class="n">z_int</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="o">=</span><span class="n">buffer_2d_real</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Vertical index order is reversed between CAM-SIMA and MPAS.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">t_mid</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reverse</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="p">:))</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">buffer_2d_real</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">p_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;p_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">qv_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;qv_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">tm_mid_col</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;tm_mid_col(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dim&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;index_qv&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;rho&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">scalars</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;scalars&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">time_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Set `rho` and `theta` column by column. This way, peak memory usage can be reduced.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="n">qv_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">scalars</span><span class="p">(</span><span class="n">index_qv</span><span class="p">,</span><span class="w"> </span><span class="p">:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)</span>
<span class="w">                </span><span class="n">tm_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t_mid</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">constant_rv</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">constant_rd</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">(:))</span>

<span class="w">                </span><span class="c">! Piecewise integrate hypsometric equation to derive `p_mid_col(1)`.</span>
<span class="w">                </span><span class="c">! The formulation used here is exact.</span>
<span class="w">                </span><span class="n">p_mid_col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_by_hypsometric_equation</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">p_sfc</span><span class="p">(</span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="n">tm_mid_col</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">(</span><span class="mi">1</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                    </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">))</span>

<span class="w">                </span><span class="c">! Piecewise integrate hypsometric equation to derive subsequent `p_mid_col(k)`.</span>
<span class="w">                </span><span class="c">! The formulation used here is exact.</span>
<span class="w">                </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span>
<span class="w">                    </span><span class="n">p_mid_col</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_by_hypsometric_equation</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">p_by_hypsometric_equation</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">p_mid_col</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="n">tm_mid_col</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                            </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">tm_mid_col</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mf">1.0_kind_r8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">qv_mid_col</span><span class="p">(</span><span class="n">k</span><span class="p">)),</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">))</span>
<span class="w">                </span><span class="k">end do</span>

<span class="k">                </span><span class="n">rho</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">p_mid_col</span><span class="p">(:)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">constant_rd</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">tm_mid_col</span><span class="p">(:)),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">                </span><span class="n">theta</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">theta_by_poisson_equation</span><span class="p">(</span><span class="n">p_mid_col</span><span class="p">,</span><span class="w"> </span><span class="n">t_mid</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">constant_p0</span><span class="p">),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">p_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">p_sfc</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">qv_mid_col</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">t_mid</span><span class="p">)</span>
<span class="w">            </span><span class="k">deallocate</span><span class="p">(</span><span class="n">tm_mid_col</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">index_qv</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">scalars</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Because we are injecting data directly into MPAS memory, halo layers need to be updated manually.</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;rho&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_mpas_state_rho_theta</span>

<span class="w">        </span><span class="c">!&gt; Set MPAS state `rho_base` (i.e., base state dry air density) and `theta_base` (i.e., base state potential temperature).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-05-21)</span>
<span class="w">        </span><span class="k">subroutine </span><span class="n">set_mpas_state_rho_base_theta_base</span><span class="p">()</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_abortutils</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">check_allocate</span>
<span class="w">            </span><span class="k">use </span><span class="n">cam_logfile</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">debugout_verbose</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_p0</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">pref</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rair</span>
<span class="w">            </span><span class="k">use </span><span class="n">vert_coord</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">pver</span>

<span class="w">            </span><span class="kt">character</span><span class="p">(</span><span class="o">*</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">subname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;dyn_comp::set_analytic_initial_condition::set_mpas_state_rho_base_theta_base&#39;</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="p">,</span><span class="w"> </span><span class="n">k</span>
<span class="w">            </span><span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">ierr</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">parameter</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">t_base</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">25</span><span class="mf">0.0_kind_r8</span><span class="w"> </span><span class="c">! Base state temperature (K) of dry isothermal atmosphere.</span>
<span class="w">                                                               </span><span class="c">! The value used here is identical to MPAS.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">allocatable</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p_base</span><span class="p">(:)</span><span class="w">            </span><span class="c">! Base state pressure (Pa) at layer midpoints of each column.</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">rho_base</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">theta_base</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_dyn_mpas</span><span class="p">),</span><span class="w"> </span><span class="k">pointer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">zz</span><span class="p">(:,</span><span class="w"> </span><span class="p">:)</span>

<span class="w">            </span><span class="k">call </span><span class="n">dyn_debug_print</span><span class="p">(</span><span class="n">debugout_verbose</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;Setting MPAS state &quot;rho_base&quot; and &quot;theta_base&quot;&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho_base</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta_base</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>

<span class="w">            </span><span class="k">allocate</span><span class="p">(</span><span class="n">p_base</span><span class="p">(</span><span class="n">pver</span><span class="p">),</span><span class="w"> </span><span class="nb">stat</span><span class="o">=</span><span class="n">ierr</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">check_allocate</span><span class="p">(</span><span class="n">ierr</span><span class="p">,</span><span class="w"> </span><span class="n">subname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;p_base(pver)&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dyn_comp&#39;</span><span class="p">,</span><span class="w"> </span><span class="err">__</span><span class="n">LINE__</span><span class="p">)</span>

<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">rho_base</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;rho_base&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">theta_base</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;diag&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;theta_base&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">get_variable_pointer</span><span class="p">(</span><span class="n">zz</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;mesh&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;zz&#39;</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Set `rho_base` and `theta_base` column by column. This way, peak memory usage can be reduced.</span>
<span class="w">            </span><span class="k">do </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">ncells_solve</span>
<span class="w">                </span><span class="k">do </span><span class="n">k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">pver</span>
<span class="w">                    </span><span class="c">! Derive `p_base` by hypsometric equation.</span>
<span class="w">                    </span><span class="c">! The formulation used here is exact and identical to MPAS.</span>
<span class="w">                    </span><span class="n">p_base</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_by_hypsometric_equation</span><span class="p">(</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">constant_p0</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="mf">0.0_kind_r8</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="n">t_base</span><span class="p">,</span><span class="w"> </span><span class="p">&amp;</span>
<span class="w">                        </span><span class="mf">0.5_kind_r8</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">zgrid</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">))</span>
<span class="w">                </span><span class="k">end do</span>

<span class="k">                </span><span class="n">rho_base</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">p_base</span><span class="p">(:)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">constant_rd</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t_base</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">zz</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">),</span><span class="w"> </span><span class="n">kind_r8</span><span class="p">)),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">                </span><span class="n">theta_base</span><span class="p">(:,</span><span class="w"> </span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kt">real</span><span class="p">(</span><span class="n">theta_by_poisson_equation</span><span class="p">(</span><span class="n">p_base</span><span class="p">,</span><span class="w"> </span><span class="n">t_base</span><span class="p">,</span><span class="w"> </span><span class="n">constant_p0</span><span class="p">),</span><span class="w"> </span><span class="n">kind_dyn_mpas</span><span class="p">)</span>
<span class="w">            </span><span class="k">end do</span>

<span class="k">            deallocate</span><span class="p">(</span><span class="n">p_base</span><span class="p">)</span>

<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">rho_base</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">theta_base</span><span class="p">)</span>
<span class="w">            </span><span class="k">nullify</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>

<span class="w">            </span><span class="c">! Because we are injecting data directly into MPAS memory, halo layers need to be updated manually.</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;rho_base&#39;</span><span class="p">)</span>
<span class="w">            </span><span class="k">call </span><span class="n">mpas_dynamical_core</span><span class="w"> </span><span class="p">%</span><span class="w"> </span><span class="n">exchange_halo</span><span class="p">(</span><span class="s1">&#39;theta_base&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">end subroutine </span><span class="n">set_mpas_state_rho_base_theta_base</span>

<span class="w">        </span><span class="c">! ----- p_2, z_2 ----- (Layer 2)</span>
<span class="w">        </span><span class="c">!       t_v</span>
<span class="w">        </span><span class="c">! ----- p_1, z_1 ----- (Layer 1)</span>
<span class="w">        </span><span class="c">!</span>
<span class="w">        </span><span class="c">!&gt; Compute the pressure `p_2` at height `z_2` from the pressure `p_1` at height `z_1` by hypsometric equation.</span>
<span class="w">        </span><span class="c">!&gt; `t_v` is the mean virtual temperature between `z_1` and `z_2`. Essentially,</span>
<span class="w">        </span><span class="c">!&gt; \( P_2 = P_1 e^{\frac{-(z_2 - z_1) g}{R_d T_v}} \).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-02)</span>
<span class="w">        </span><span class="k">pure elemental function </span><span class="n">p_by_hypsometric_equation</span><span class="p">(</span><span class="n">p_1</span><span class="p">,</span><span class="w"> </span><span class="n">z_1</span><span class="p">,</span><span class="w"> </span><span class="n">t_v</span><span class="p">,</span><span class="w"> </span><span class="n">z_2</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">p_2</span><span class="p">)</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">gravit</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rair</span>

<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p_1</span><span class="p">,</span><span class="w"> </span><span class="n">z_1</span><span class="p">,</span><span class="w"> </span><span class="n">t_v</span><span class="p">,</span><span class="w"> </span><span class="n">z_2</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p_2</span>

<span class="w">            </span><span class="n">p_2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">p_1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nb">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">z_2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">z_1</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">constant_g</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">constant_rd</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t_v</span><span class="p">))</span>
<span class="w">        </span><span class="k">end function </span><span class="n">p_by_hypsometric_equation</span>

<span class="w">        </span><span class="c">! ----- p_1, t_1 ----- (Arbitrary layer)</span>
<span class="w">        </span><span class="c">!</span>
<span class="w">        </span><span class="c">! ----- p_0, t_0 ----- (Reference layer)</span>
<span class="w">        </span><span class="c">!</span>
<span class="w">        </span><span class="c">!&gt; Compute the potential temperature `t_0` at reference pressure `p_0` from the temperature `t_1` at pressure `p_1` by</span>
<span class="w">        </span><span class="c">!&gt; Poisson equation. Essentially,</span>
<span class="w">        </span><span class="c">!&gt; \( \theta = T (\frac{P_0}{P})^{\frac{R_d}{C_p}} \).</span>
<span class="w">        </span><span class="c">!&gt; (KCW, 2024-07-02)</span>
<span class="w">        </span><span class="k">pure elemental function </span><span class="n">theta_by_poisson_equation</span><span class="p">(</span><span class="n">p_1</span><span class="p">,</span><span class="w"> </span><span class="n">t_1</span><span class="p">,</span><span class="w"> </span><span class="n">p_0</span><span class="p">)</span><span class="w"> </span><span class="k">result</span><span class="p">(</span><span class="n">t_0</span><span class="p">)</span>
<span class="w">            </span><span class="c">! Module(s) from CAM-SIMA.</span>
<span class="w">            </span><span class="k">use </span><span class="n">dynconst</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">constant_cpd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">cpair</span><span class="p">,</span><span class="w"> </span><span class="n">constant_rd</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">rair</span>

<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">),</span><span class="w"> </span><span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">p_1</span><span class="p">,</span><span class="w"> </span><span class="n">t_1</span><span class="p">,</span><span class="w"> </span><span class="n">p_0</span>
<span class="w">            </span><span class="kt">real</span><span class="p">(</span><span class="n">kind_r8</span><span class="p">)</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">t_0</span>

<span class="w">            </span><span class="n">t_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">t_1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">((</span><span class="n">p_0</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">p_1</span><span class="p">)</span><span class="w"> </span><span class="o">**</span><span class="w"> </span><span class="p">(</span><span class="n">constant_rd</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">constant_cpd</span><span class="p">))</span>
<span class="w">        </span><span class="k">end function </span><span class="n">theta_by_poisson_equation</span>
<span class="w">    </span><span class="k">end subroutine </span><span class="n">set_analytic_initial_condition</span>
</pre></div>

        </section>
        <br>
    </div>
  </div>
      <hr>
    </div>

    <footer>
      <div class="container">
        <div class="row justify-content-between">
          <div class="col">
            <p>
              MPAS Dynamical Core
was developed by CAM-SIMA & MPAS Developers<br>              Â© 2025 
            </p>
          </div>
          <div class="col">
            <p class="text-end">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div>
    </footer>
  </body>
</html>